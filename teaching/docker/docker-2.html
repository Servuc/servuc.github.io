<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Thomas SELLE (aka. Servuc) - Docker TP2</title>
    <link rel="stylesheet" href="/dist/style.css">
</head>
<body>

<div class="top-bar">
    <div class="top-bar-left">
        <ul class="menu">
            <li class="menu-text">Docker - TP 2 : Dockerfile</li>
            <li><a href="#" data-summary="basic">Une image basique</a></li>
            <li><a href="#" data-summary="perso">Très personnalisable</a></li>
        </ul>
    </div>

    <div class="top-bar-right">
        <ul class="menu">
            <li class="menu-text">Thomas SELLE (aka. Servuc)</li>
            <li><a href="/">Servuc.fr</a></li>
        </ul>
    </div>
</div>


<div class="slider">
    <div>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                    <h1 class="padding10">Docker - TP 2 : Dockerfile</h1>
                    <h2>Thomas S.</h2>
                    <h3 class="pull-right">2018-2019</h3>
                </div>
            </div>
        </div>
    </div>

    <div>
        <h1 class="text-center" data-summary="summary">Docker - TP 2 : Dockerfile</h1>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                <h2>Sommaire</h2>
                    <ul>
                        <li>Une image basique</li>
                        <li>Très personnalisable</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div>
        <h1 class="text-center">Une image basique</h1>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                    <h2>Dockerf... quoi ?</h2>
                    <ul>
                        <li>Fichier permettant de <span class="code">build</span> un image</li>
                        <li>Nom du fichier : <span class="code">Dockerfile</span></li>
                        <li>Script de définition propre à Docker</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div>
        <h1 class="text-center">Une image basique</h1>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                    <h2>Tips, le .dockerignore</h2>

                    <p>
                        Fonctionne comme le <i>.gitignore</i>, permet d'éviter de prendre en compte des fichiers au <b>build</b>.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div>
        <h1 class="text-center">Une image basique</h1>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                    <h2>Dockerfile</h2>
                    <div class="code">
                        FROM debian<br />
                        <br />
                        RUN apt-get update -y && \<br />
                        &nbsp;&nbsp;&nbsp;&nbsp;apt-get install -y cowsay<br />
                        <br />
                        CMD /usr/games/cowsay "Hello World !"
                    </div>
                    <div class="code">
                        docker build -t test .<br />
                        docker run test
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div>
        <h1 class="text-center" data-summary="perso">Très personnalisable</h1>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                    <h2>Instructions <a href="https://docs.docker.com/engine/reference/builder/" target="_blank"><i class="fa fa-external-link"></i></a></h2>
                    <ul>
                        <li><span class="code">FROM</span> : Base de l'image</li>
                        <li><span class="code">RUN</span> : Commandes requises pour mettre en place</li>
                        <li><span class="code">CMD</span> : Ce qui doit être éxécuté</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div>
        <h1 class="text-center">Très personnalisable</h1>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                    <h2>Instructions <a href="https://docs.docker.com/engine/reference/builder/" target="_blank"><i class="fa fa-external-link"></i></a></h2>
                    <ul>
                        <li><span class="code">VOLUME</span> : Lié volume entre container et host</li>
                        <li><span class="code">EXPOSE</span> : Ports ouverts du container vers l'host</li>
                        <li><span class="code">COPY</span> <span class="code">ADD</span> : Copier des fichiers dans l'image (Diff. <a href="https://stackoverflow.com/a/24958548/2558648"><i class="fa fa-external-link"></i></a>)</li>
                        <li><span class="code">WORKDIR</span> : Définit le chemin d'éxécution</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div>
        <h1 class="text-center">Très personnalisable</h1>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                    <h2>TP1</h2>
                    <div>
                        Faire une image <span class="code">Ubuntu</span> permettant de donner le <a href="https://launchpad.net/coreutils" target="_blank">checksum MD5</a> du <a href="http://proof.ovh.net/files/1Mb.dat" target="_blank">fichier suivant</a> (directement présent dans l'image).<br />
                        Solution : d6dd8a9fdac2c00e4d7bc9b0ab2d383d<br />
                        Faire 3 variantes :
                        <ul>
                            <li>Avec wget (Dans un RUN du Dockerfile)</li>
                            <li>Avec ADD/COPY (dans le Dockerfile)</li>
                            <li>Avec volume</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div>
        <h1 class="text-center">Très personnalisable</h1>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                    <h2>TP1</h2>
                    <div>
                        Faire une image <span class="code">php:apache</span> permettant d'afficher ce projet <a href="https://github.com/fatz/hello-world-php-slim" target="_blank"><b>Hello World !</b> du framework <b>Slim</b></a> sur le port 9876 de l'host<br />
                        (Attention, ça ne sert à rien d'utiliser <span class="code">-v</span>).<br />
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div>
        <h1 class="text-center">Très personnalisable</h1>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                    <h2>Images multiples</h2>
                    <ul>
                        <li>Images séparées par <span class="code">FROM</span></li>
                        <li>Utilité : Créé des images légères</li>
                        <li>Seul la dernière image est conservée</li>
                        <li>TL;DR : Idéal dans la mise en place/compilation logiciel</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div>
        <h1 class="text-center">Très personnalisable</h1>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                    <h2>Images multiples : exemple</h2>
                    <div class="code">
                        FROM ubuntu AS build-env<br />
                           //Some compilation<br />
                        FROM debian<br />
                        COPY --from=build-env /path/on/build/env.so /usr/local/lib/<br /><br />
                        CMD ........
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div>
        <h1 class="text-center">Très personnalisable</h1>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                    <h2>TP3</h2>
                    <div>
                        Faire une image Linux du projet <a href="https://github.com/fanux/tetris" target="_blank">Tetris <li class="fa fa-external-link"></li></a>, compilée à partir d'une autre image Linux. Pour l'éxécuter, il faudra la lancer en <span class="code">ENTRYPOINT</span> dans l'image <a href="https://hub.docker.com/_/debian?tab=tags&page=1&name=buster-slim" target="_blank">debian:buster-slim</a>.<br />
                        Pour les plus fort, faire une compilation statique et mettre l'éxécutable dans une image <a href="https://hub.docker.com/_/busybox" target="_blank">busybox</a>.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div>
        <h1 class="text-center">Très personnalisable</h1>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                    <h2>TP4</h2>
                    <div>
                        Faire une image avec un serveur web. Cette application web doit être modifiable en live. L'objectif est de changer le temps de réponse d'une page pour mettre en avant le <a href="https://docs.docker.com/engine/reference/builder/#healthcheck" target="_blank"><span class="code">HEALTHCHECK</span><li class="fa fa-external-link"></li></a>.<br />
                        À l'exécution, il faudra choisir la bonne politique de redémarrage <a href="https://docs.docker.com/engine/reference/run/#restart-policies---restart" target="_blank"><span class="code">--restart</span><li class="fa fa-external-link"></li></a>.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div>
        <h1 class="text-center">Très personnalisable</h1>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                    <h2>Docker Hub</h2>
                    <ul>
                        <li>Registre pour sauvegarder ses containers</li>
                        <li><a href="https://docs.docker.com/registry/deploying/">Version personnelle <i class="fa fa-external-link"></i></a></li>
                        <li><span class="code">docker login</span> (Inscription <a href="https://hub.docker.com/" class="fa fa-external-link">ici</a>)</li>
                        <li><span class="code">docker push NOM_DE_L_IMAGE</span></li>
                        <li>Le nom de l'image devra être sous la forme : <i>pseudo/image_name:version</i></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div>
        <h1 class="text-center">Très personnalisable</h1>
        <div class="slider-slide">
            <div class="row">
                <div class="column">
                    <h2>Gitlab et intégration continue</h2>
                    <script src="https://gist.github.com/Servuc/c98ef355d35848438c8da19d93adf979.js?file=.gitlab-ci.yml"></script>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="slider-dots">
    Dernière maj : Voir <a href="https://github.com/Servuc/servuc.github.io">Github</a> 🐻 <span data="now">1</span> / <span data="total"></span>
</div>

<div class="slider-button-nav-prev"><i class="fa fa-arrow-circle-left"></i> Précédent</div>
<div class="slider-button-nav-next">Suivant <i class="fa fa-arrow-circle-right"></i></div>

<script src="/dist/jquery.min.js"></script>
<script src="/dist/foundation.min.js"></script>
<script src="/dist/slick.min.js"></script>
<script src="/dist/teaching.js"></script>
</body>
</html>
